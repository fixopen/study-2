<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>W-我的-设置-添加新卡-发送后页面</title>
    <!-- 禁止拉伸和全屏设置 -->
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no"
          id="viewport"/>
    <meta name="format-detection" content="telephone=no"/>
    <meta name="screen-orientation" content="portrait">

    <!-- 引入样式表 -->
    <link rel="stylesheet" href="global.css">
    <link rel="stylesheet" href="common.css">
    <link rel="stylesheet" href="index.css">
    <script type="text/javascript" src="jquery/jquery.min.js"></script>
</head>
<body>
<div class="wrap">
    <!-- main -->
    <div class="set-main">
        <ul class="set-ul">
            <li class="set-li">
                <span class="set-span">卡号</span>
                <input type="text" placeholder="请输入卡号" id="cardCode" required pattern="\d+">
            </li>
            <li class="set-li">
                <span class="set-span">密码</span>
                <input type="password" placeholder="请输入密码" id="password" required>
            </li>
            <li class="set-li">
                <span class="set-span">手机号</span>
                <input type="tel" placeholder="请输入手机号" id="phonecode" required pattern="\d+">
                <a href="javascript:void(0)" id="getCode" class="send-btn cur">获取验证码</a>
                <a href="javascript:void(0)" class="sencond-btn"><span>60</span>s</a>
                <a href="javascript:void(0)" onclick="getCode()" class="re-send-btn">重新发送</a>
            </li>
            <li class="set-li">
                <span class="set-span">验证码</span>
                <input type="text" placeholder="请输入验证码" id="validationCode" required pattern="\d{6}">
            </li>
        </ul>
        <div class="tip">卡片验证码将发送至此手机!</div>

        <div class="btn-box">
            <a href="javascript:void(0)" onclick="post()" class="save-btn">确 认</a>
        </div>
    </div>
</div>
<script>
    var getCodeButton = document.getElementById('getCode')
    getCodeButton.addEventListener('click', function (e) {
        e.preventDefault();
//        var the_s = 188888;//定义剩余时间, 必须用时间戳.单位为秒
//        setInterval(promote, 1000);//每秒执行一次下面的函数
//        function promote() {
//            var d = Math.floor((the_s / 3600) / 24);
//            var g = Math.floor((the_s - d * 24 * 3600) / 3600);
//            var e = Math.floor((the_s - d * 24 * 3600 - g * 3600) / 60);
//            var f = (the_s - g * 3600) % 60;
//            var html = "还剩<b>" + d + "</b>天<b>" + g + "</b>时<b>" + e + "</b>分<b>" + f + "</b>秒";
//            document.getElementById("divdown1").innerHTML = html;//这个id是你想要显示的div的id
//            the_s--;
//        }

        var phonecode = $('#phonecode').val()
        $.ajax({
            type: "get",
            url: "api/users/telephones/" + phonecode + "/code",
            dataType: "json",
            async: false,
            success: function (data) {
                alert("返回结果集=" + data);
            },
            error: function (r) {
                alert("返回结果集=" + r.statusText);
            }
        })
    })

    function post() {
        var data = {};
        data.cardCode = $('#cardCode').val()
        data.password = $('#password').val()
        data.phonecode = $('#phonecode').val()
        data.validationCode = $('#validationCode').val()
        $.ajax({
            type: "post",
            url: "api/users/cards",
            data: JSON.stringify(data),
            dataType: "json",
            contentType: "application/json",
            success: function (data) {
                alert("返回结果集=" + data);
            }
        })
    }

</script>
</body>
</html>