<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>用户信息</title>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no"
          id="viewport"/>
    <meta name="format-detection" content="telephone=no"/>
    <meta name="screen-orientation" content="portrait"/>
    <link rel="stylesheet" href="common.css"/>
    <!-- 引入样式表 -->
    <link rel="stylesheet" href="/css/global.css">
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="basic-info.css">

    <!-- 引入js -->
    <script type="text/javascript" src="/zepto/zepto.min.js"></script>
    <script type="text/javascript" src="/zepto/touch.js"></script>
    <script type="text/javascript" src="/zepto/selector.js"></script>
    <script src="util.js"></script>
    <script src="../basic.js"></script>

</head>
<body>
<article id="user">

</article>
<article id="cards" style="display: none;">
    <ul id="actived-cards"></ul>
    <button id="recharge">充值</button>
    <button id="append-card">添加卡</button>
</article>
<article id="info" style="display: none;"></article>
<article id="logs" style="display: none;"></article>
<article id="consumes" style="display: none;"></article>
<article id="study" style="display: none;"></article>
<article id="score" style="display: none;"></article>
<article id="change-password" style="display: none;"></article>
<article id="activeCard" style="display: none;">
    <section style="overflow: hidden; background-color: #fff; border-top: 1px solid #e5e5e5;">
        <div>
            <span class="common-font common-line-height title">卡号</span>
            <input type="text" id="cardNo" class="common-font common-line-height common-border-style value"
                   placeholder="请输入卡号" required pattern="\d+"/>
        </div>
        <div>
            <span class="common-font common-line-height title">密码</span>
            <input type="password" id="password" class="common-font common-line-height common-border-style value"
                   placeholder="请输入密码" required/>
        </div>
    </section>
    <div id="tips" class="common-font common-line-height common-border-style tips">欢迎来到激活卡页面!</div>
    <input type="button" id="save" class="common-font common-line-height common-border-style save" value="确 认"/>
</article>
<article id="firstActiveCard" style="display: none;">
    <section style="overflow: hidden; background-color: #fff; border-top: 1px solid #e5e5e5;">
        <div>
            <span class="common-font common-line-height title">卡号</span>
            <input type="text" id="first-cardNo" class="common-font common-line-height common-border-style value"
                   placeholder="请输入卡号" required pattern="\d+"/>
        </div>
        <div>
            <span class="common-font common-line-height title">密码</span>
            <input type="password" id="first-password" class="common-font common-line-height common-border-style value"
                   placeholder="请输入密码" required/>
        </div>
        <div>
            <span class="common-font common-line-height title">手机号</span>
            <input type="tel" id="phoneNumber" class="common-font common-line-height common-border-style value"
                   placeholder="请输入手机号" required pattern="\d+"/>
            <input type="button" id="activeCode" class="common-font common-border-style validButton" value="获取手机验证码"/>
        </div>
        <div>
            <span class="common-font common-line-height title">验证码</span>
            <input type="text" id="validCode" class="common-font common-line-height common-border-style value"
                   placeholder="请输入验证码" required pattern="\d{6}"/>
        </div>
    </section>
    <div id="first-tips" class="common-font common-line-height common-border-style tips">欢迎来到激活卡页面!</div>
    <input type="button" id="first-save" class="common-font common-line-height common-border-style save" value="确 认"/>
</article>
<article id="login" style="display: none;">
    <div>
        <span class="common-font common-line-height title">手机号</span>
        <input type="tel" id="login-account" class="common-font common-line-height common-border-style value"
               placeholder="请输入手机号" required pattern="\d+"/>
    </div>
    <div>
        <span class="common-font common-line-height title">密码</span>
        <input type="text" id="login-password" class="common-font common-line-height common-border-style value"
               placeholder="请输入验证码" required pattern="\d{6}"/>
    </div>
</article>
<article id="phone-login" style="display: none;">
    <div>
        <span class="common-font common-line-height title">手机号</span>
        <input type="tel" id="login-phoneNumber" class="common-font common-line-height common-border-style value"
               placeholder="请输入手机号" required pattern="\d+"/>
        <input type="button" id="login-activeCode" class="common-font common-border-style validButton" value="获取手机验证码"/>
    </div>
    <div>
        <span class="common-font common-line-height title">验证码</span>
        <input type="text" id="login-validCode" class="common-font common-line-height common-border-style value"
               placeholder="请输入验证码" required pattern="\d{6}"/>
    </div>
</article>
<article id="settings" style="display: none;"></article>
<article id="help" style="display: none;">
    <div class="wrap">
        <!-- main -->
        <div class="set-main">
            <div class="convert">
                100积分=1金豆
            </div>

            <!-- member-table -->
            <table class="member-table">
                <tr>
                    <td>会员等级</td>
                    <td>积分</td>
                    <td>购买折扣率</td>
                </tr>
                <tr>
                    <td>铜牌会员</td>
                    <td>0-1000</td>
                    <td>100%</td>
                </tr>
                <tr>
                    <td>银牌会员</td>
                    <td>1001-3000</td>
                    <td>99%</td>
                </tr>
                <tr>
                    <td>金牌会员</td>
                    <td>3001-6000</td>
                    <td>98%</td>
                </tr>
                <tr>
                    <td>白金会员</td>
                    <td>6001-12000</td>
                    <td>97%</td>
                </tr>
                <tr>
                    <td>钻石会员</td>
                    <td>12001-24000</td>
                    <td>95%</td>
                </tr>
            </table>

            <table class="member-table">
                <tr>
                    <td>用户行为</td>
                    <td>积分</td>
                    <td>备注</td>
                </tr>
                <tr>
                    <td>新用户首次登录</td>
                    <td>50</td>
                    <td>首次注册并完善我的账号信息送50积分</td>
                </tr>
                <tr>
                    <td>登录</td>
                    <td>3/天</td>
                    <td>每天只在第一次登录加分</td>
                </tr>
                <tr>
                    <td>发送给朋友分享</td>
                    <td>1/条</td>
                    <td>每天最高10分</td>
                </tr>
                <tr>
                    <td>连续登录5天</td>
                    <td>2/天</td>
                    <td></td>
                </tr>
                <tr>
                    <td>连续登录10天</td>
                    <td>5/天</td>
                    <td></td>
                </tr>
                <tr>
                    <td>连续登录20天</td>
                    <td>10/天</td>
                    <td></td>
                </tr>
                <tr>
                    <td>连续登录30天</td>
                    <td>15/天</td>
                    <td></td>
                </tr>
                <tr>
                    <td>连续发送，分享20天</td>
                    <td>10/天</td>
                    <td></td>
                </tr>
                <tr>
                    <td>连续发送，分享30天</td>
                    <td>15/天</td>
                    <td></td>
                </tr>
                <tr>
                    <td>在线时长1-10分钟</td>
                    <td>2</td>
                    <td>每天最高4分</td>
                </tr>
                <tr>
                    <td>在线时长10-30分钟</td>
                    <td>3</td>
                    <td>每天最高4分</td>
                </tr>
                <tr>
                    <td>在线时长30分钟以上</td>
                    <td>4</td>
                    <td>每天最高4分</td>
                </tr>
                <tr>
                    <td>充值5金豆</td>
                    <td>1</td>
                    <td></td>
                </tr>
                <tr>
                    <td>充值10金豆</td>
                    <td>2</td>
                    <td></td>
                </tr>
                <tr>
                    <td>充值20金豆</td>
                    <td>4</td>
                    <td></td>
                </tr>
                <tr>
                    <td>充值30金豆</td>
                    <td>6</td>
                    <td></td>
                </tr>
                <tr>
                    <td>充值50金豆</td>
                    <td>10</td>
                    <td></td>
                </tr>
                <tr>
                    <td>充值100金豆</td>
                    <td>20</td>
                    <td></td>
                </tr>
                <tr>
                    <td>会员生日当天</td>
                    <td>4</td>
                    <td></td>
                </tr>
                <tr>
                    <td>评论</td>
                    <td>1/条</td>
                    <td>每天最高10分</td>
                </tr>
            </table>
        </div>
    </div>
</article>

<template id="user-template">
   <!-- <section>
        <span>我的头像</span>
        <img src="${head}" alt="">
    </section>
    <section>
        <span>昵称</span>
        <input type="text" value="${name}" readonly>
    </section>
    <section>
        <span>账号</span>
        <input type="text" value="${telephone}" readonly>
    </section>
    <section>
        <a href="#">我的资料</a>
    </section>
    <section>
        <a href="#">我的学习卡</a>
    </section>
    <section>
        <a href="#">设置</a>
    </section>
    <section>
        <a href="#">帮助</a>
    </section>-->
    <div class="mine_zilo">
        <ul class="mine_zUl">
            <li class="mine_zuli">
                <span class="mine_leftsp">我的头像</span>
                <img class="mine_touimg" src="${head}" alt="">
            </li>
            <li class="mine_zuli">
                <span class="mine_leftsp">昵称</span>
                <input class="mine_rightip" type="text" value="${name}" readonly>
            </li>
            <li class="mine_zuli">
                <span class="mine_leftsp">账号</span>
                <input class="mine_rightip" type="text" value="${telephone}" readonly>
            </li>
            <li>
                <a href="info.html" class="mine_zuli">
                    我的资料
                </a>
            </li>
        </ul>
        <ul class="mine_zUl">
            <li>
                <section data-id="card-template" class="mine_zuli">我的学习卡</section>
            </li>
        </ul>
        <ul class="mine_zUl">
            <li class="mine_zuli">设置</li>
            <li class="mine_zuli" data-article="help">帮助</li>
        </ul>
    </div>
</template>
<template id="info-template">
    <article>
        <section>
            <span>真实姓名</span>
            <input type="text" placeholder="请输入真实姓名" value="${name}">
        </section>
        <section>
            <span>手机号</span>
            <input type="tel" value="${telephone}">
        </section>
        <section>
            <span>性别</span>
            <input type="text" value="${sexName}">
        </section>
        <section>
            <span>出生年月</span>
            <input type="date" value="${birthday}">
        </section>
        <section>
            <span>收货地址</span>
            <input type="text" placeholder="请输入收货地址" value="${location}">
        </section>
        <section >
            <span class="mine_leftsp">就读学校</span>
            <input class="mine_rightip" type="text" value="${school}">
        </section>
        <section>
            <span>所在班级</span>
            <input type="text" value="${grade} ${classname}">
        </section>
    </article>
</template>
<template id="card-template">
    <article>
        <section>
            <span>卡号</span>
            <span>${no}</span>
        </section>
        <section>
            <span>学习类型</span>
            <span>${subjectName}</span>
        </section>
        <section>
            <span>激活时间</span>
            <span>${activeTime}</span>
        </section>
        <section>
            <span>剩余雨点</span>
            <span>${amount}</span>
        </section>
        <section>
            <span>有效期</span>
            <span>${endTime}</span>
        </section>
    </article>
</template>
<template id="consume-template">
    <li>
        <p>${time}</p>
        <p>${direction}</p>
        <p><span>${amount}</span>金豆</p>
    </li>
</template>
<template id="study-template"></template>

<template id="help-template">

</template>

<!--<dialog>添加成功啦！<br>请到我的学习卡里~</dialog>-->

<script src="/jquery/jquery-3.1.1.min.js"></script>
<script src="/util.js"></script>
<script>
    var user = null

    var state = {
        currentArticle: document.getElementById('volumes'),
        init: function () {
            var userId = g.getUrlParameter('userid')
            g.setCookie('userId', userId)

            $('[data-article]').on('click', function (e) {
                state.currentArticle.style.display = 'none'
                state.currentArticle = document.getElementById(e.target.dataset.article)
                state.currentArticle.style.display = 'block'
                state[state.currentArticle.id].init()
            }, false)

            state['user'].init()
        },
        user: {
            init: function() {
                if (user == null) {
                    $.ajax({
                        type: 'get',
                        url: '/api/users/self',
                        dataType: 'json',
                        success: function (u) {
                            proc({
                                containerId: 'user',
                                data: u,
                                templateId:'user-template'
                            })
                        },
                        error:function (u) {
                            alert(JSON.stringify(u))
                        }
                    })
                }
            }
        },
        cards: {
            init: function() {
                if (!user.cards) {
                    $.ajax({
                        type: 'get',
                        url: '/api/users/self/cards',
                        dataType: 'json',
                        success: function (cs) {
                            alert(1)
                            user.cards = cs
                        }
                    })
                } else {
                    alert(1)
                    proc({
                        templateId: 'card-template',
                    })
                }
            }
        },
        info: {
            init: function() {}
        },
        logs: {
            init: function() {}
        },
        consumes: {
            init: function() {}
        },
        study: {
            init: function() {}
        },
        score: {
            init: function() {}
        },
        changePassword: {
            init: function() {}
        },
        activeCard: {
            init: function() {}
        },
        firstActiveCard: {
            init: function() {}
        },
        login: {
            init: function() {}
        },
        phoneLogin: {
            init: function() {}
        },
        settings: {
            init: function() {}
        },
        help: {
            init: function() {}
        }
    }

    state.init()
</script>
</body>
</html>