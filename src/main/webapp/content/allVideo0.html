<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>直播课</title>
	<!-- 禁止拉伸和全屏设置 -->
  	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no" id="viewport" />
    <meta name="format-detection" content="telephone=no" />

    <!-- 引入样式表 -->
    <link rel="stylesheet" href="../css/global.css">
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="allVideo0.css">

    <!-- 引入js -->
    <script type="text/javascript" src="../js/zepto.min.js"></script>
    <script type="text/javascript" src="../js/touch.js"></script>
    <script type="text/javascript" src="../js/selector.js"></script>
    <script type="text/javascript" src="allVideo0.js"></script>

</head>
<body>
	<div class="wrap noBackg">

		<!-- main -->
		<input class="souSuo clearfix" type="text" placeholder="请输入科目、老师、年级 关键词搜索">
		<div class="tiao_jian">
			<div class="tiaoj_TJ01 selectDiv">
				<div class="tiaoj_1span">
					<span>科目</span>
					<img src="../img/xiala.png" alt="">
				</div>
				<ul class="xiala_ul">
					<li class="xiala_li">语文</li>
					<li class="xiala_li">数学</li>
				</ul>
			</div>
			<div class="tiaoj_TJ02 selectDiv">
				<div class="tiaoj_2span">
					<span>老师</span>
					<img src="../img/xiala.png" alt="">
				</div>
				<ul class="xiala_ul">
					<li class="xiala_li">刘志超</li>
					<li class="xiala_li">范炜炜</li>
					<li class="xiala_li">曹文雯</li>
					<li class="xiala_li">朱东博</li>
				</ul>
			</div>
			<div class="tiaoj_TJ03 selectDiv">
				<div class="tiaoj_3span">
					<span>年级</span>
					<img src="../img/xiala.png" alt="">
				</div>
				<ul class="xiala_ul">
					<li class="xiala_li">一年级</li>
					<li class="xiala_li">二年级</li>
					<li class="xiala_li">三年级</li>
					<li class="xiala_li">四年级</li>
					<li class="xiala_li">五年级</li>
					<li class="xiala_li">六年级</li>
					<li class="xiala_li">一~三年级</li>
					<li class="xiala_li">四~六年级</li>
				</ul>
			</div>
		</div>
		<div class="rain-main noPadd">
			<ul id="video"></ul>
            <div class="bottom_txt">
            	<span class="leftLine">————</span>没有更多视频咯！<span class="leftLine">————</span>
            </div>
		</div>
	</div>
	<template id="video-template">
		<li class="all_uli">
			<div class="all_liplay">
				<a class="all_aBtn" href="javascript:void(0)">
					<div class="yuwen_div0"><span>${goldBean}</span>金豆</div>
					<div class="yuwen_div1">${subject}</div>
					<div class="yuwen_div2">
						<h3 class="yuwen_h3">${title}</h3>
						<p class="yuwen_p">${description}</p>
					</div>
					<span class="yuwen_a"></span>
					<span class="yuwen_span">—${teacher}老师</span>
				</a>
			</div>
			<div class="course-intro">
				<div class="course_xiaqing">
					<div class="xiaq_div">${description}</div>
					<div>
						<span>${grade}</span>
						<div class="course_detail">课程详情</div>
					</div>
				</div>
				<div class="course-detail">
					<h3 class="sml-tit brief1">
						<img src="images/abc.png" alt="">
						课程简介
					</h3>
					<p>${description}</p>
					<h3 class="sml-tit brief2">
						<img src="images/zjr_btn.png" alt="">
						主讲人简介
					</h3>
					<p class="tim2">	${teacherDescription}</p>

					<h3 class="sml-tit brief3">
						<img src="images/sxsj_btn.png" alt="">
						上线时间
					</h3>
					<p>${startTime}</p>

					<h3 class="sml-tit brief4">
						<img src="images/cksc_btn.png" alt="">
						课程时长
					</h3>
					<p>${duration}分钟</p>
				</div>
			</div>
		</li>
	</template>
	<script type="text/javascript">
		allxqTap(); //all课程详情
		xialaTap(); //下拉
	</script>
	<script type="text/javascript">
		curseDetailTap();
		var userId = g.getUrlParameter('userid')
		g.setCookie('userId', userId)
		var course = []
		var getGrade = function (gradeValue) {
			var result = ''
			if (gradeValue == 1) {
				result = '一年级'
			} else if (gradeValue == 2) {
				result = '二年级'
			} else if (gradeValue == 3) {
				result = '三年级'
			} else if (gradeValue == 4) {
				result = '四年级'
			} else if (gradeValue == 5) {
				result = '五年级'
			} else if (gradeValue == 6) {
				result = '六年级'
			} else if (gradeValue == 20) {
				result = '1-2年级'
			} else {
				result = '3-6年级'
			}
			return result
		}

		var now = new Date();
		var filter = {}
		filter.endTime = '< ' + now
		filter.cdnLike = ' != NULL'
		filter.subjectId = 3
		filter.teacher=
		filter.grade=
		g.ajaxProcess('GET', '/api/schedulers?filter=' + JSON.stringify(filter), [
			{name: 'Accept', value: 'application/json'}
		], null, function (result) {
			course[0] = result.data
			g.ajaxProcess('GET', '/api/schedulers?filter={"subjectId":2}', [
				{name: 'Accept', value: 'application/json'}
			], null, function (result) {
				course[1] = result.data
				var adjustData = function (subject) {
					for (var i = 0; i < course[subject].length; ++i) {
						for (var j = 0; j < course[subject][i].length; ++j) {
							var m = moment().year(course[subject][i][j].year).week(course[subject][i][j].week).day(course[subject][i][j].day)
							course[subject][i][j].month = m.month()
							course[subject][i][j].day = m.date()
							course[subject][i][j].grade = getGrade(course[subject][i][j].grade)
						}
					}
				}
				adjustData(0)
				adjustData(1)
					proc({
						container: video,
						data: course,
						template: video-template
					})
				curseDetailTap();
			})
		})
	</script>
</body>
</html>