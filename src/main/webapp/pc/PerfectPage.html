<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>完善页面</title>
    <script src="../jquery/jquery.min.js"></script>
    <script src="util.js"></script>
    <script src="birthdy.js"></script>
    <script src="city.js"></script>
    <link rel="stylesheet" href="link.css">
</head>
<script>
    $(function () {
        let phonecode = g.getUrlParameter("phonecode")
        $("#phonecodeId").val(phonecode);
        $("#phonecodeId").attr("readonly",true);
        $("#birthday_container").birthday();
        city()

    })


    function ss() {
        let data={
            name: $('#realname').val(),
            telephone:$('#phonecodeId').val(),
            sex: $("input[type='radio']:checked").val(),
            birthday: $("select[name='year']").val()+$("select[name='month']").val()+$("select[name='day']").val(),
            location: $('#receipt_address').val(),
            school: $('#school').val(),
            class : $('#classes').val(),
            /*ref_id : $('#weixinhao').val()*/
        }
        $.ajax({
            type:"post",
            url:"/api/users/pcuser",
            data:JSON.stringify(data),
            dataType:"json",
            contentType: "application/json; charset=utf-8",
            success:function (pcuser) {
                alert(JSON.stringify(pcuser))
                alert("添加成功")
            }, error: function (pcuser) {
                alert(JSON.stringify(pcuser))
                alert("添加失败")
            }
        })
    }
</script>
<body>

<img src="images/首页/u15.png" height="240" width="228"/>
<div style="position:absolute; left:240px; top:200px; ">
    <h3>完善信息</h3>
</div>
<div>
    <table style="font-size: 30px;">
        <tr>
            <td>*真实姓名：</td>
            <td><input type="text" class="it" id="realname"/></td>
        </tr>

        <tr>
            <td>*手机号：</td>
            <td><input type="text" id="phonecodeId" class="it"/></td>
        </tr>
        <tr>
            <td>*性别：</td>
            <td>
                <input type="radio" value="1" name="sex"/>男
                <input type="radio" value="0" name="sex"/>女
            </td>
        </tr>
        <tr>
            <td>*出生年月：</td>
            <td id="birthday_container">
                <select name="year"></select>
                <select name="month"></select>
                <select name="day"></select>
            </td>
        </tr>
        <tr>
            <td>*收货地址：</td>
            <td>
                <select name="province" id="province"></select>
                <select name="city" id="city"></select>
                <select name="county" id="county"></select>
            </td>
        </tr>
        <tr>
            <td></td>
            <td>
                <input type="text" id="receipt_address" class="it"/>
            </td>
        </tr>
        <tr>
            <td>就读学校：</td>
            <td><input type="text" class="it" id="school"/></td>
        </tr>
        <tr>
            <td>所在班级：</td>
            <td><input type="text" class="it" id="classes"/></td>
        </tr>
        <tr>
            <td>*微信账号：</td>
            <td><input type="text" class="it" id="weixinhao"/></td>
        </tr>
    </table>
        <button class="save" onclick="ss()">提交</button>
</div>
<script>
    let china = {
        "beijing": {
            "chaoyang": ["..", ".."],
            "haidian": []
        },
        "shanghai": {
            "xx": ["ss", "cx"]
        },
        //....
    }
    let state = [
        {"index": 0, "text": ""},
        {"index": 0, "text": ""},
        {"index": 0, "text": ""}
    ]

    let state2 = {
        "province": "",
        "city": "",
        "county": ""
    }

    let p = document.getElementById('pr')
    let c = doc
    let x = doc

    let addr = doc

    //<option value="...">...</option>

    x.addEventListener('change', function(e) {
        state2.county = e.target.value
        addr.value = state2.province + state2.city + state2.county
    })

    c.addEventListener('change', function(e) {
        state2.city = e.target.value

        x.innerHTML = ''
        for (let i = 0; i < china[state2.province][state2.city].length; ++i) {
            let option = document.createElement('option')
            option.setAttribute('value', china[state2.province][state2.city][i])
            option.innerHTML = china[state2.province][state2.city][i]
            x.appendChild(option)
        }
        x.selectedIndex = 0
        state2.city = x.value

        addr.value = state2.province + state2.city + state2.county
    })

    p.addEventListener('change', function(e) {
        state2.province = e.target.value

        c.innerHTML = ''
        for (let cv in china[state2.province]) {
            let option = document.createElement('option')
            option.setAttribute('value', china[state2.province][cv])
            option.innerHTML = china[state2.province][cv]
            c.appendChild(option)
        }
        c.selectedIndex = 0
        state2.city = c.value

        x.innerHTML = ''
        for (let i = 0; i < china[state2.province][state2.city].length; ++i) {
            let option = document.createElement('option')
            option.setAttribute('value', china[state2.province][state2.city][i])
            option.innerHTML = china[state2.province][state2.city][i]
            x.appendChild(option)
        }
        x.selectedIndex = 0
        state2.county = x.value

        addr.value = state2.province + state2.city + state2.county
    })
</script>
</body>
</html>